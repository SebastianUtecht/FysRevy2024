<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<title>README.html</title>

</head>

<body>

<p>Det her er scriptet, der kører browser-delen af fysikrevyen™s
AV-system, og de tilhørende css-filer.</p>

<p>Selve præsentationen kan køre indlæst i en browser fra filsystemet,
men de mere avancerede funktioner (fjernstyringssiden, synkronisering
mellem flere sider, oversættelse af undertekstformater) kræver at de
bliver hentet via serverdelen
<a href="https://www.npmjs.com/package/@fysikrevy/sse-server">sse-server</a>.</p>

<h1 id="hurtigstartpåpunktform">Hurtig start, på punktform</h1>

<p>(0) Hent og installer <a href="https://nodejs.org/">node.js</a>. I tilfælde af
tvivl, gå efter LTS versionen.</p>

<ol>
<li><p>Lav en ny mappe til revyen, og naviger til den i en terminal.</p></li>
<li><p>Installer server-delen globalt.</p>

<pre><code>] npm install -g @fysikrevy/sse-server
</code></pre></li>
<li><p>Start en ny <code>npm</code>-pakke, som kan holde styr på vores afhængigheder:</p>

<pre><code>] npm init
</code></pre></li>
</ol>

<p><code>npm</code> vil nu spørge efter en masse informationer. Siden det ikke er
meningen, at denne pakke skal udgives i <code>npm</code> er det sikkert bare
at skippe disse spørgsmål, ved at trykke enter ved hver.</p>

<ol>
<li><p>Hent denne pakke.</p>

<pre><code>] npm install @fysikrevy/av-main
</code></pre></li>
<li><p>Kopier filen <code>node_modules/@fysikrevy/av-main/revy-template.html</code> i
din revymappe (kald den fx <code>revy.html</code>), og skriv dine overtekster
dér.</p>

<p>For automatisk omskrivning af .tex-filer til html, kig i
<a href="https://www.npmjs.com/package/@fysikrevy/av-helpers">av-helpers</a>. Der
er eksempler på hvad der kan stå i et revy-html-dokument i
<a href="https://www.npmjs.com/package/@fysikrevy/av-demo">av-demo</a>.</p></li>
<li><p>Start serveren, ved at skrive</p>

<pre><code>] sse-server
</code></pre>

<p>Naviger et browser-vindue på projektoren til</p>

<pre><code>localhost/revy.html
</code></pre>

<p>og et andet browser-vindue på din egen skærm til</p>

<pre><code>localhost/revy.remote
</code></pre>

<p>Forhåbentlig giver fjernstyringssiden sig selv.</p>

<p>Brug Chrome. Firefox ser ud til at have et problem med, hvordan vi
stopper og starter videoer, og sætter sig fast.</p>

<p>Læg mærke til, at Chrome (og Firefox)
<a href="https://developer.chrome.com/blog/autoplay/">blokerer videoer, der prøver at starte sig selv som standard</a>. Det
kan fikses ved at starte chrome med parameteren
<code>--autoplay-policy=no-user-gesture-required</code>. På Windows,
højreklik på en genvej til Chrome, og sæt parameteren ind helt til
sidst, efter et mellemrum, i feltet &#8220;Destination&#8221; (eller &#8220;Target&#8221;).</p></li>
</ol>

<h1 id="hvadderskalståihtml-filen">Hvad der skal stå i html-filen</h1>

<p><code>revy-template.html</code> giver skelettet af hvad scriptet forventer, at
der står i html-filen. Hvert <code>article</code>-element i <code>section</code>-elementet
bliver set som overteksterne til en sketch eller sang. Hvis
<code>article</code>-elementet har en <code>id</code>-attribut, bruger fjernstyringssiden
det som overskrift i oversigten.</p>

<h2 id="sangtekster">Sangtekster</h2>

<p>Sangtekster kommer til at være hovedparten af AV til en
revy. <code>article</code>-elementet der inheholder teksten til en sang bør have
klasserne <code>build</code> og <code>lyr</code>, og hver linje bør være i sit eget
<code>p</code>-element. For eksempel:</p>

<pre><code>&lt;article class=&quot;build lyr&quot;&gt;
  &lt;p&gt;Bamse og Kylling siger&lt;/p&gt;
  &lt;p&gt;SPRÆNG!&lt;/p&gt;
&lt;/article&gt;
</code></pre>

<p>Det kan være nødvendigt at have flere linjer synlige på samme tid,
eller bryde lange linjer om:</p>

<pre><code>  &lt;p&gt;Det var i nitten-niogfyrre, &lt;br /&gt; eller circa deromkring&lt;/p&gt;
</code></pre>

<p>For ikke at spolere en punchline kan vi skjule en del af en linje
indtil det rigtige øjeblik:</p>

<pre><code>  &lt;p class=&quot;build&quot;&gt;Det er jo &lt;span&gt;Datalogen!&lt;/span&gt;&lt;/p&gt;
</code></pre>

<h2 id="billeder">Billeder</h2>

<p><code>img</code>-elmentet kan bruges hvor som helst. Det kan være brugbart, hvis
et billede har sit eget <code>div</code>-element at bo i, så klassen <code>pagediv</code>
fylder sin forælder, og centrerer sit indhold. Et dias, som viser en
serie billeder i fuld skærm et ad gangen kan se ud som følger:</p>

<pre><code>&lt;article class=&quot;build kill&quot;&gt;
  &lt;div class=&quot;pagediv&quot;&gt;&lt;img src=&quot;billeder/b1.jpg&quot; height=&quot;100%&quot;&gt;&lt;/div&gt;
  &lt;div class=&quot;pagediv&quot;&gt;&lt;img src=&quot;billeder/b2.jpg&quot; height=&quot;100%&quot;&gt;&lt;/div&gt;
  &lt;div class=&quot;pagediv&quot;&gt;&lt;img src=&quot;billeder/b3.jpg&quot; height=&quot;100%&quot;&gt;&lt;/div&gt;
&lt;/article&gt;
</code></pre>

<h2 id="videoer">Videoer</h2>

<p>Et dias med en video kan se ud som følger:</p>

<pre><code>&lt;article class=&quot;vidframe build&quot; id=&quot;bandintro&quot; &gt;
    &lt;video preload=&quot;none&quot; &gt;
        &lt;source src=&quot;fisk/Poisson.mp4&quot; type=&quot;video/mp4&quot; /&gt;
        &lt;track src=&quot;fisk/Poisson.vtt&quot; 
           kind=&quot;subtitles&quot; 
           srclang=&quot;da-DK&quot; default /&gt;
    &lt;/video&gt;
&lt;/article&gt;
</code></pre>

<p>Klassen <code>vidframe</code> sørger for, at videoer bliver skaleret
korrekt.</p>

<p>Forudindlæsning er slået fra, ved at sætte <code>preload</code> til
<code>none</code>, for at forbedre genindlæsningstiden.</p>

<p>Det er for tiden videofiler i mp4 (h.264) format, der har den bedste
chance for at være kompatibel med en given browser. Nogen specifikke
browsere har bredere kompatibilitet, men skal under alle
omstændigheder helst have at vide hvilken type videofil de får, via
<code>type</code>-parameteren. Hvis dine fiskekreatørere giver dig videoer i
ubrugelige formater, så er der altid
<a href="https://handbrake.fr/">handbrake</a>.</p>

<p>Vtt-formatet bruges til undertekster i browsere og <em>ingen andre
steder</em><sup>[Citation needed]</sup>. Derfor kan server-delen
konvertere .srt og .ass filer til vtt on-the-fly, så længe de har det
samme navn, op til filtypenavnet.</p>

<h1 id="justértilskærmen">Justér til skærmen</h1>

<p>Helt kort, bliver det styret af css-egenskaberne <code>margin-left</code>,
<code>margin-right</code> og <code>transform</code> for reglerne <code>.slides &gt; article</code> og
<code>.slides &gt; .vidframe</code>.</p>

<p>De findes i filen <code>node_modules/@fysikrevy/av-main/av.css</code>, som er
temmelig lang. Men et sted derinde står der noget i retningen af</p>

<pre><code>.slides &gt; article {
      
  [...]
      
  margin-left: -75px;
  margin-right: -50px;
      
  transform: scale( 3.6 );
      
  [...]
}
</code></pre>

<p>og</p>

<pre><code>.slides &gt; .vidframe {
  [...]
  margin-left: -500px;
  margin-top: -340px;
  transform: scale( 1.2 );
}
</code></pre>

<p>Tallet efter <code>margin-left</code> styrer den horisontale position,
<code>margin-top</code> styrer den vertikale position og tallet inde i <code>scale( )</code>
styrer zoom.</p>

<p>Der er helt forskellige tal for <code>.vidframe</code> og ting, som ikke er
<code>.vidframe</code>. Det gav mening engang, og forhåbentlig er der nogen, der
har overskud til at fikse det, på et tidspunkt&#8230;</p>

<p>Det er muligt at eksperimentere med de her tal interaktivt i
browserens inspector-vindue (prøv at trykke F12). <code>av.css</code> kan
kopieres til revy-mappen, og serveren vil tage den kopi i stedet for
filen i <code>av-main</code>-mappen, hvis du vil holde ændringer fri af selve
<code>av-main</code>-mappen.</p>

<h1 id="detdermedflereprojektorere">Det der, med flere projektorere</h1>

<p>Ud over <code>.remote</code> og <code>.html</code> giver serveren seperate versioner af
revy-filen med endelserne <code>.left</code>, <code>.mid</code> og <code>.right</code>. På de sider
vises elementer, som er markeret med en <code>for</code> attribut, som enten
matcher sidens endelse, eller <code>span</code>, som vises på alle tre sider.</p>

<p>For eksempel, betragt følgende html-brudstykke:</p>

<pre><code>&lt;article class=&quot;lyr kill&quot; id =&quot;23_UskyldigSang&quot;&gt;
  &lt;article class=&quot;build kill vidframe&quot; for=&quot;span&quot;&gt;
    &lt;video for=&quot;span&quot; preload=&quot;none&quot; class=&quot;build&quot; dur=&quot;0&quot;&gt;
      &lt;source src=&quot;uskyldig/Empty.m4v&quot; type=&quot;video/mp4&quot; class=&quot;auto&quot; for=&quot;span&quot; /&gt;
      &lt;p&gt;Jeg sidder her på kanten af min stol&lt;/p&gt;
      &lt;p&gt;Regner på MekRel&lt;/p&gt;
      &lt;p&gt;Åh så mange ting jeg ik forstår&lt;/p&gt;
      &lt;p&gt;Bare du ku’ fortælle&lt;/p&gt;
      &lt;p&gt;Jeg ved jo godt det kun er noget&lt;/p&gt;
      &lt;p&gt;Der foregår i mit eget hoved&lt;/p&gt;
    &lt;/video&gt;
    &lt;video loop for=&quot;span&quot; preload=&quot;none&quot; class=&quot;build&quot;&gt;
      &lt;source src=&quot;uskyldig/Newton.m4v&quot; type=&quot;video/mp4&quot; class=&quot;auto&quot;  for=&quot;span&quot; /&gt;
      &lt;p class=&quot;auto&quot;&gt;Jeg syn’s jo bare du var sød&lt;/p&gt; &lt;!-- newton --&gt;
      &lt;p class=&quot;build&quot;&gt;Newton vil &lt;span&gt;du&lt;/span&gt; &lt;span&gt;læg’ dig&lt;/span&gt; &lt;/p&gt;
      &lt;p class=&quot;build&quot;&gt;Ned så jeg ka &lt;span&gt;flæk’ dig&lt;/span&gt;&lt;/p&gt;
      &lt;p&gt;Du ku’ være min stjernefyr&lt;/p&gt;
    &lt;/video&gt;
  &lt;/article&gt;
&lt;/article&gt;
</code></pre>

<p>Vi forsøger, at bygge to forskellige html-dokumentstrukturer, som kan
vises på to projektorere, men hvor de to dokumenter er enuge om,
hvordan listen over elementer, som skal bygges, ser ud. Altså, som
tidligere nævnt, hvilke elementer, som er præcis ét element under et
element med klassen <code>build</code>. Derfor vil hovedprojektoren&#8212;den, hvor
siden har endelsen <code>.html</code>&#8212;ikke vise elementer, som er markeret med
en <code>for</code> attribut til en af de andre sider, mens fx siden med endelsen
<code>.left</code> <em>kun</em> viser elementer, som er markeret <code>for</code> <code>left</code> eller
<code>span</code>.</p>

<p>Så, <code>.html</code>-siden vil se ud som om dokumentet kun indeholdt:</p>

<pre><code>&lt;article class=&quot;lyr kill&quot; id =&quot;23_UskyldigSang&quot;&gt;
   &lt;p&gt;Jeg sidder her på kanten af min stol&lt;/p&gt;
   &lt;p&gt;Regner på MekRel&lt;/p&gt;
   &lt;p&gt;Åh så mange ting jeg ik forstår&lt;/p&gt;
   &lt;p&gt;Bare du ku’ fortælle&lt;/p&gt;
   &lt;p&gt;Jeg ved jo godt det kun er noget&lt;/p&gt;
   &lt;p&gt;Der foregår i mit eget hoved&lt;/p&gt;
   &lt;p class=&quot;auto&quot;&gt;Jeg syn’s jo bare du var sød&lt;/p&gt; &lt;!-- newton --&gt;
   &lt;p class=&quot;build&quot;&gt;Newton vil &lt;span&gt;du&lt;/span&gt; &lt;span&gt;læg’ dig&lt;/span&gt; &lt;/p&gt;
   &lt;p class=&quot;build&quot;&gt;Ned så jeg ka &lt;span&gt;flæk’ dig&lt;/span&gt;&lt;/p&gt;
   &lt;p&gt;Du ku’ være min stjernefyr&lt;/p&gt;
&lt;/article&gt;
</code></pre>

<p>og fx <code>.left</code>-siden vil se ud som om dokumentet kun indeholdt:</p>

<pre><code>&lt;article class=&quot;lyr kill&quot; id =&quot;23_UskyldigSang&quot;&gt;
  &lt;video for=&quot;span&quot; preload=&quot;none&quot; class=&quot;build&quot; dur=&quot;0&quot;&gt;
    &lt;source src=&quot;uskyldig/Empty.m4v&quot; type=&quot;video/mp4&quot; class=&quot;auto&quot; for=&quot;span&quot; /&gt;
  &lt;/video&gt;
  &lt;video loop for=&quot;span&quot; preload=&quot;none&quot; class=&quot;build&quot;&gt;
    &lt;source src=&quot;uskyldig/Newton.m4v&quot; type=&quot;video/mp4&quot; class=&quot;auto&quot;  for=&quot;span&quot; /&gt;
  &lt;/video&gt;
&lt;/article&gt;
</code></pre>

<p>Men begge sider vil være enige om, at listen over elementer, som skal
bygges er:</p>

<ol>
<li><code>&lt;video for=&quot;span&quot; preload=&quot;none&quot; class=&quot;build&quot; dur=&quot;0&quot;&gt;</code></li>
<li><code>&lt;p&gt;Jeg sidder her på kanten af min stol&lt;/p&gt;</code></li>
<li><code>&lt;p&gt;Regner på MekRel&lt;/p&gt;</code></li>
<li><code>&lt;p&gt;Åh så mange ting jeg ik forstår&lt;/p&gt;</code></li>
<li><code>&lt;p&gt;Bare du ku’ fortælle&lt;/p&gt;</code></li>
<li><code>&lt;p&gt;Jeg ved jo godt det kun er noget&lt;/p&gt;</code></li>
<li><code>&lt;p&gt;Der foregår i mit eget hoved&lt;/p&gt;</code></li>
<li><code>&lt;video loop for=&quot;span&quot; preload=&quot;none&quot; class=&quot;build&quot;&gt;</code></li>
<li><code>&lt;p class=&quot;build&quot;&gt;Newton vil</code></li>
<li><code>&lt;span&gt;du&lt;/span&gt;</code></li>
<li><code>&lt;span&gt;læg’ dig&lt;/span&gt;</code></li>
<li><code>&lt;p class=&quot;build&quot;&gt;Ned så jeg ka</code></li>
<li><code>&lt;span&gt;flæk’ dig&lt;/span&gt;</code></li>
<li><code>&lt;p&gt;Du ku’ være min stjernefyr&lt;/p&gt;</code></li>
</ol>

<p>(Vi springer elementer med klassen <code>auto</code> over, fordi de bliver bygget
automatisk.)</p>

<p>Placeringen af elementerne i billedet styres af reglerne for</p>

<pre><code>body.right section.slides article[for=&quot;span&quot;]{
</code></pre>

<p>og</p>

<pre><code>body.left section.slides article[for=&quot;span&quot;]{
</code></pre>

<p>i <code>av.css</code>. Det ser ud til, at noget af implementeringen for
<code>for</code>-attributter, som ikke er <code>span</code> mangler&#8230;</p>

<h2 id="versioner">Versioner</h2>

<h6 id="1.3.2">1.3.2</h6>

<blockquote>
<p>Opdateret &#8220;nej&#8221;&#8211;mekanisme. Den endte med mest at bo i
server-delen. Et par løste bugs omkring medie-afspilning. Udvidet
README.</p>
</blockquote>

<h6 id="1.2.0">1.2.0</h6>

<blockquote>
<p>Opdateret mediekontrol, så &#8220;goto&#8221; (når man navigerer ved at klikke
på et element, i modsætning til frem/tilage taster) starter medier
forfra.</p>
</blockquote>

<h6 id="1.1.1-1.1.3">1.1.1 - 1.1.3</h6>

<blockquote>
<p>Fixet interaktionen mellem <code>prev</code>, <code>last-built</code> og <code>auto</code> (det burde
fungere bedre, at gå baglæns i en slide). Introduceret jquery som
afhængighed, for et nemmere liv. Introduceret <code>.build-me</code> som
alternativ til <code>.build &gt; *</code>.</p>
</blockquote>

<h5 id="1.1.0">1.1.0</h5>

<blockquote>
<p>Fix: Kan lave mellemrum i d-linjer igen.
Ny implementering af mimic-mekanisme. Kan nu afspille
videoer. Muligvis begrænset bagud-kompatabilitet.</p>
</blockquote>

</body>
</html>
